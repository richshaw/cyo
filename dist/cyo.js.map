{"version":3,"sources":["src/app.module.js","src/app.config.js","src/shared/choice/choiceDirective.js","src/shared/choice/choiceController.js","src/shared/condition/conditionDirective.js","src/shared/condition/conditionController.js","src/shared/event/eventDirective.js","src/shared/event/eventController.js","src/shared/page/pageDirective.js","src/shared/page/pageController.js","src/shared/restart/restartDirective.js","src/shared/restart/restartController.js","src/shared/story/storyDirective.js","src/shared/story/storyController.js"],"names":["runBlock","angular","module","run","$inject","configBlock","config","constant","choice","restrict","controller","directive","choiceController","$scope","$attrs","$element","choiceName","hasOwnProperty","name","$attr","Object","keys","element","on","completedPages","push","pageName","decisions","$apply","$watch","pages","indexOf","console","error","css","condition","conditionController","activate","activated","storyEvents","isNegative","conditionValid","isCondition","event","eventController","info","storyEvent","index","splice","shift","page","$sce","$templateRequest","$compile","pageLink","$ctrls","templateUrl","getTrustedResourceUrl","src","then","template","html","contents","scope","link","pageController","length","isFirstPage","restart","restartController","forEach","A","pop","story","storyController","choices"],"mappings":"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","file":"cyo.js","sourcesContent":["(function() {\n    'use strict';\n\n    angular.module('cyo', []);\n\n    /**\n    Run app\n    */\n    angular\n        .module('cyo')\n        .run(runBlock);\n\n    runBlock.$inject = [];\n\n    function runBlock() {\n\n    }\n\n})();","(function() {\n    'use strict';\n\n  angular\n      .module('cyo')\n      .config(configBlock)\n      .constant('CONFIG',{\n      });\n\n    configBlock.$inject = [];\n\n    function configBlock() {\n\n\n    }\n})();","(function() {\n    'use strict';\n\n    angular\n    .module('cyo')\n    .directive('choice', choice);\n\n    choice.$inject = [];\n\n    function choice() {\n        return {\n            restrict: \"EA\",\n            controller: \"choiceController\",\n        }\n    }\n})();","(function() {\n    'use strict';\n\n    angular\n        .module('cyo')\n        .controller('choiceController', choiceController)\n\n    choiceController.$inject = ['$scope','$attrs','$element'];\n\n    function choiceController($scope,$attrs,$element) {\n\n        var choiceName;\n        if($attrs.hasOwnProperty('choice')) {\n            choiceName = $attrs.choice;\n        }\n        else if($attrs.hasOwnProperty('name')) {\n            choiceName = $attrs.name;\n        }\n        else {\n            choiceName = $attrs.$attr[Object.keys($attrs.$attr)[0]];\n        }\n\n        angular.element($element).on(\"click\", function() {\n            $scope.completedPages.push($scope.pageName);\n            $scope.decisions.push(choiceName);\n            $scope.$apply();\n        });\n\n        $scope.$watch(\"pages\", function() {\n            if ($scope.pages.indexOf(choiceName) == -1) {\n                console.error(\"A choice has no corresponding page,\", choiceName);\n                $element.css(\"border\", \"2px solid red\");\n                $element.css(\"pointer-events\", \"none\");\n            }\n        }, true);\n\n        $scope.$watch(\"completedPages\", function() {\n            if ($scope.completedPages.indexOf($scope.pageName) > -1) {\n                $element.css(\"display\", \"none\");\n            } else {\n                $element.css(\"display\", \"inline-block\");\n            }\n        }, true)\n    }\n})();","(function() {\n    'use strict';\n\n    angular\n    .module('cyo')\n    .directive('condition', condition);\n\n    condition.$inject = [];\n\n    function condition() {\n        return {\n            restrict: \"EA\",\n            controller: \"conditionController\",\n        }\n    }\n})();","(function() {\n    'use strict';\n\n    angular\n        .module('cyo')\n        .controller('conditionController', conditionController)\n\n    conditionController.$inject = ['$scope','$attrs','$element'];\n\n    function conditionController($scope,$attrs,$element) {\n        $element.css(\"display\", \"none\");\n        \n        var condition;\n        if($attrs.hasOwnProperty('condition')) {\n            condition = $attrs.condition;\n        }\n        else if($attrs.hasOwnProperty('name')) {\n            condition = $attrs.name;\n        }\n        else {\n            condition = $attrs.$attr[Object.keys($attrs.$attr)[0]];\n        }\n\n        var isNegative = false;\n        var activated = false;\n\n        $scope.isCondition = true;\n\n        if ($attrs.hasOwnProperty('unless') || $attrs.hasOwnProperty('not')) {\n            isNegative = true;\n        };\n\n        function activate() {\n            if (activated) return;\n            activated = true;\n            if ($scope.storyEvents.indexOf(condition) > -1 && !isNegative) {\n                $scope.conditionValid = true;\n                $element.css(\"display\", \"block\");\n            } else if ($scope.storyEvents.indexOf(condition) == -1 && isNegative) {\n                $scope.conditionValid = true;\n                $element.css(\"display\", \"block\");\n            }\n        }\n\n        $scope.$watch(\"decisions\", function() {\n            if ($scope.decisions.indexOf($scope.pageName) > -1) {\n                activate();\n            } else {\n                activated = false;\n                $element.css(\"display\", \"none\");\n            }\n        }, true);\n    }\n})();","(function() {\n    'use strict';\n\n    angular\n    .module('cyo')\n    .directive('event', event);\n\n    event.$inject = [];\n\n    function event() {\n        return {\n            restrict: \"EA\",\n            controller: \"eventController\",\n        }\n    }\n})();","(function() {\n    'use strict';\n\n    angular\n        .module('cyo')\n        .controller('eventController', eventController)\n\n    eventController.$inject = ['$scope','$attrs','$element'];\n\n    function eventController($scope,$attrs,$element) {\n\n        var storyEvent;\n        if($attrs.hasOwnProperty('event')) {\n            storyEvent = $attrs.event;\n        }\n        else if($attrs.hasOwnProperty('name')) {\n            storyEvent = $attrs.name;\n        }\n        else {\n            storyEvent = $attrs.$attr[Object.keys($attrs.$attr)[0]];\n        }\n\n        var isNegative = false;\n        if (storyEvent === \"clear\") {\n            isNegative = true;\n            storyEvent.shift();\n        };\n\n        var activated = false;\n\n        function activate() {\n            if (activated) return;\n            activated = true;\n            if ($scope.isCondition && !$scope.conditionValid) {\n                return;\n            };\n\n            console.info(\"Activating this event\", storyEvent, !isNegative);\n\n            if (!isNegative) {\n                $scope.storyEvents.push(storyEvent);\n            } else {\n                var index = $scope.storyEvents.indexOf(storyEvent);\n                $scope.storyEvents.splice(index, 1);\n            };\n        }\n\n        $scope.$watch(\"decisions\", function() {\n            if ($scope.decisions.indexOf($scope.pageName) > -1) {\n                activate();\n            } else {\n                activated = false;\n            }\n        }, true);\n    }\n})();","(function() {\n    'use strict';\n\n    angular\n    .module('cyo')\n    .directive('page', page);\n\n    page.$inject = ['$sce','$templateRequest','$compile'];\n\n    function page($sce,$templateRequest,$compile) {\n        return {\n            restrict: \"EA\",\n            scope: true,\n            controller: \"pageController\",\n            link: pageLink\n        }\n\n        function pageLink($scope, $element, $attr, $ctrls) {\n            // Load external template if defined\n            if($attr.hasOwnProperty(\"src\")) {\n                // From http://stackoverflow.com/questions/24496201/load-html-template-from-file-into-a-variable-in-angularjs\n                // @Todo: Security check\n                var templateUrl = $sce.getTrustedResourceUrl($attr.src);\n\n                $templateRequest(templateUrl).then(function(template) {\n                    // template is the HTML template as a string\n                    $element.html(template);\n                    $compile($element.contents())($scope);\n                }, function() {\n                    // An error has occurred\n                });\n\n            }\n\n        }\n    }\n})();","(function() {\n    'use strict';\n\n    angular\n        .module('cyo')\n        .controller('pageController', pageController)\n\n    pageController.$inject = ['$scope','$attrs','$element'];\n\n    function pageController($scope,$attrs,$element) {\n        if ($scope.pages.length) {\n            $element.css(\"display\", \"none\");\n        } else {\n            $scope.isFirstPage = true;\n        }\n\n        if($attrs.hasOwnProperty('page')) {\n            $scope.pageName = $attrs.page;\n        }\n        else if($attrs.hasOwnProperty('name')) {\n            $scope.pageName = $attrs.name;\n        }\n        else {\n            $scope.pageName = $attrs.$attr[Object.keys($attrs.$attr)[0]];\n        }\n        \n        $scope.pages.push($scope.pageName);\n\n        $scope.$watch(\"decisions\", function() {\n            if ($scope.decisions.indexOf($scope.pageName) > -1) {\n                $element.css(\"display\", \"block\");\n            } else if (!$scope.isFirstPage) {\n                $element.css(\"display\", \"none\");\n            }\n        }, true);\n    }\n})();","(function() {\n    'use strict';\n\n    angular\n    .module('cyo')\n    .directive('restart', restart);\n\n    restart.$inject = [];\n\n    function restart() {\n        return {\n            restrict: \"EA\",\n            scope: true,\n            controller: \"restartController\",\n        }\n    }\n})();","(function() {\n    'use strict';\n\n    angular\n        .module('cyo')\n        .controller('restartController', restartController)\n\n    restartController.$inject = ['$scope','$attrs','$element'];\n\n    function restartController($scope,$attrs,$element) {\n        angular.element($element).on(\"click\", function() {\n            [$scope.storyEvents, $scope.decisions, $scope.completedPages].forEach(function(A) {\n                while (A.length > 0) {\n                    A.pop();\n                }\n            });\n\n            $scope.$apply();\n        });\n    }\n})();","(function() {\n    'use strict';\n\n    angular\n    .module('cyo')\n    .directive('story', story);\n\n    story.$inject = [];\n\n    function story() {\n        return {\n            restrict: 'EA',\n            scope: true,\n            controller: 'storyController'\n        }\n    }\n})();","(function() {\n    'use strict';\n\n    angular\n        .module('cyo')\n        .controller('storyController', storyController)\n\n    storyController.$inject = ['$scope','$attrs','$element'];\n\n    function storyController($scope,$attrs,$element) {\n        $scope.storyEvents = [];\n        $scope.choices = [];\n        $scope.pages = [];\n        $scope.completedPages = [];\n        $scope.decisions = ['intro'];\n    }\n})();\n"],"sourceRoot":"/source/"}
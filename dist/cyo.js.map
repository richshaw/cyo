{"version":3,"sources":["src/app.module.js","src/app.config.js","src/shared/choice/choiceDirective.js","src/shared/choice/choiceController.js","src/shared/condition/conditionDirective.js","src/shared/condition/conditionController.js","src/shared/event/eventDirective.js","src/shared/event/eventController.js","src/shared/page/pageDirective.js","src/shared/page/pageController.js","src/shared/restart/restartDirective.js","src/shared/restart/restartController.js","src/shared/story/storyDirective.js","src/shared/story/storyController.js","src/shared/story/storyService.js"],"names":["runBlock","angular","module","run","$inject","configBlock","config","constant","choice","restrict","controller","directive","choiceController","$scope","$attrs","$element","$animate","choiceName","hasOwnProperty","name","$attr","Object","keys","element","on","completedPages","push","pageName","decisions","$apply","$watch","pages","indexOf","console","error","css","addClass","removeClass","condition","conditionController","activate","activated","storyEvents","isNegative","conditionValid","isCondition","event","eventController","info","storyEvent","index","splice","shift","page","$sce","$templateRequest","$compile","$parse","pageLink","$ctrls","path","src","templateUrl","getTrustedResourceUrl","then","template","html","contents","scope","link","pageController","length","isFirstPage","restart","restartController","forEach","A","pop","story","storyController","storyService","storyName","extend","getStory","updateStory","registerStory","func","updateFunctions","updateStories","log","i","stories","resetStory","choices","this","factory"],"mappings":"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","file":"cyo.js","sourcesContent":["(function() {\n    'use strict';\n\n    angular.module('cyo', ['ngAnimate']);\n\n    /**\n    Run app\n    */\n    angular\n        .module('cyo')\n        .run(runBlock);\n\n    runBlock.$inject = [];\n\n    function runBlock() {\n\n    }\n\n})();","(function() {\n    'use strict';\n\n  angular\n      .module('cyo')\n      .config(configBlock)\n      .constant('CONFIG',{\n      });\n\n    configBlock.$inject = [];\n\n    function configBlock() {\n\n\n    }\n})();","(function() {\n    'use strict';\n\n    angular\n    .module('cyo')\n    .directive('choice', choice);\n\n    choice.$inject = [];\n\n    function choice() {\n        return {\n            restrict: \"EA\",\n            controller: \"choiceController\",\n        }\n    }\n})();","(function() {\n    'use strict';\n\n    angular\n        .module('cyo')\n        .controller('choiceController', choiceController)\n\n    choiceController.$inject = ['$scope','$attrs','$element','$animate'];\n\n    function choiceController($scope,$attrs,$element,$animate) {\n\n        var choiceName;\n        if($attrs.hasOwnProperty('choice')) {\n            choiceName = $attrs.choice;\n        }\n        else if($attrs.hasOwnProperty('name')) {\n            choiceName = $attrs.name;\n        }\n        else {\n            choiceName = $attrs.$attr[Object.keys($attrs.$attr)[0]];\n        }\n\n        angular.element($element).on(\"click\", function() {\n            $scope.completedPages.push($scope.pageName);\n            $scope.decisions.push(choiceName);\n            $scope.$apply();\n        });\n\n        $scope.$watch(\"pages\", function() {\n            if ($scope.pages.indexOf(choiceName) == -1) {\n                console.error(\"A choice has no corresponding page,\", choiceName);\n                $element.css(\"border\", \"2px solid red\");\n                $element.css(\"pointer-events\", \"none\");\n            }\n        }, true);\n\n        $scope.$watch(\"completedPages\", function() {\n            if ($scope.completedPages.indexOf($scope.pageName) > -1) {\n                $animate.addClass($element,'ng-hide');\n            } else {\n                $animate.removeClass($element,'ng-hide');\n            }\n        }, true)\n    }\n})();","(function() {\n    'use strict';\n\n    angular\n    .module('cyo')\n    .directive('condition', condition);\n\n    condition.$inject = [];\n\n    function condition() {\n        return {\n            restrict: \"EA\",\n            controller: \"conditionController\",\n        }\n    }\n})();","(function() {\n    'use strict';\n\n    angular\n        .module('cyo')\n        .controller('conditionController', conditionController)\n\n    conditionController.$inject = ['$scope','$attrs','$element'];\n\n    function conditionController($scope,$attrs,$element) {\n        $element.css(\"display\", \"none\");\n        \n        var condition;\n        if($attrs.hasOwnProperty('condition')) {\n            condition = $attrs.condition;\n        }\n        else if($attrs.hasOwnProperty('name')) {\n            condition = $attrs.name;\n        }\n        else {\n            condition = $attrs.$attr[Object.keys($attrs.$attr)[0]];\n        }\n\n        var isNegative = false;\n        var activated = false;\n\n        $scope.isCondition = true;\n\n        if ($attrs.hasOwnProperty('unless') || $attrs.hasOwnProperty('not')) {\n            isNegative = true;\n        };\n\n        function activate() {\n            if (activated) return;\n            activated = true;\n            if ($scope.storyEvents.indexOf(condition) > -1 && !isNegative) {\n                $scope.conditionValid = true;\n                $element.css(\"display\", \"block\");\n            } else if ($scope.storyEvents.indexOf(condition) == -1 && isNegative) {\n                $scope.conditionValid = true;\n                $element.css(\"display\", \"block\");\n            }\n        }\n\n        $scope.$watch(\"decisions\", function() {\n            if ($scope.decisions.indexOf($scope.pageName) > -1) {\n                activate();\n            } else {\n                activated = false;\n                $element.css(\"display\", \"none\");\n            }\n        }, true);\n    }\n})();","(function() {\n    'use strict';\n\n    angular\n    .module('cyo')\n    .directive('event', event);\n\n    event.$inject = [];\n\n    function event() {\n        return {\n            restrict: \"EA\",\n            controller: \"eventController\",\n        }\n    }\n})();","(function() {\n    'use strict';\n\n    angular\n        .module('cyo')\n        .controller('eventController', eventController)\n\n    eventController.$inject = ['$scope','$attrs','$element'];\n\n    function eventController($scope,$attrs,$element) {\n\n        var storyEvent;\n        if($attrs.hasOwnProperty('event')) {\n            storyEvent = $attrs.event;\n        }\n        else if($attrs.hasOwnProperty('name')) {\n            storyEvent = $attrs.name;\n        }\n        else {\n            storyEvent = $attrs.$attr[Object.keys($attrs.$attr)[0]];\n        }\n\n        var isNegative = false;\n        if (storyEvent === \"clear\") {\n            isNegative = true;\n            storyEvent.shift();\n        };\n\n        var activated = false;\n\n        function activate() {\n            if (activated) return;\n            activated = true;\n            if ($scope.isCondition && !$scope.conditionValid) {\n                return;\n            };\n\n            console.info(\"Activating this event\", storyEvent, !isNegative);\n\n            if (!isNegative) {\n                $scope.storyEvents.push(storyEvent);\n            } else {\n                var index = $scope.storyEvents.indexOf(storyEvent);\n                $scope.storyEvents.splice(index, 1);\n            };\n        }\n\n        $scope.$watch(\"decisions\", function() {\n            if ($scope.decisions.indexOf($scope.pageName) > -1) {\n                activate();\n            } else {\n                activated = false;\n            }\n        }, true);\n    }\n})();","(function() {\n    'use strict';\n\n    angular\n    .module('cyo')\n    .directive('page', page);\n\n    page.$inject = ['$sce','$templateRequest','$compile','$parse'];\n\n    function page($sce,$templateRequest,$compile,$parse) {\n        return {\n            restrict: \"EA\",\n            scope: true,\n            controller: \"pageController\",\n            link: pageLink\n        }\n\n        function pageLink($scope, $element, $attr, $ctrls) {\n            // Load external template if defined\n            if($attr.hasOwnProperty(\"src\")) {\n                // From http://stackoverflow.com/questions/24496201/load-html-template-from-file-into-a-variable-in-angularjs\n                // @Todo: Security check\n                var path = $parse($attr.src)($scope);\n                var templateUrl = $sce.getTrustedResourceUrl(path);\n\n                $templateRequest(templateUrl).then(function(template) {\n                    // template is the HTML template as a string\n                    $element.html(template);\n                    $compile($element.contents())($scope);\n                }, function() {\n                    // An error has occurred\n                });\n            }\n\n        }\n    }\n})();","(function() {\n    'use strict';\n\n    angular\n        .module('cyo')\n        .controller('pageController', pageController)\n\n    pageController.$inject = ['$scope','$attrs','$element','$animate'];\n\n    function pageController($scope,$attrs,$element,$animate) {\n        if ($scope.pages.length) {\n            $animate.addClass($element,'ng-hide');\n        } else {\n            $scope.isFirstPage = true;\n        }\n\n        if($attrs.hasOwnProperty('page')) {\n            $scope.pageName = $attrs.page;\n        }\n        else if($attrs.hasOwnProperty('name')) {\n            $scope.pageName = $attrs.name;\n        }\n        else {\n            $scope.pageName = $attrs.$attr[Object.keys($attrs.$attr)[0]];\n        }\n        \n        $scope.pages.push($scope.pageName);\n\n        $scope.$watch(\"decisions\", function() {\n            if ($scope.decisions.indexOf($scope.pageName) > -1) {\n                $animate.removeClass($element,'ng-hide');\n            } else if (!$scope.isFirstPage) {\n                $animate.addClass($element,'ng-hide');\n            }\n        }, true);\n    }\n})();","(function() {\n    'use strict';\n\n    angular\n    .module('cyo')\n    .directive('restart', restart);\n\n    restart.$inject = [];\n\n    function restart() {\n        return {\n            restrict: \"EA\",\n            scope: true,\n            controller: \"restartController\",\n        }\n    }\n})();","(function() {\n    'use strict';\n\n    angular\n        .module('cyo')\n        .controller('restartController', restartController)\n\n    restartController.$inject = ['$scope','$attrs','$element'];\n\n    function restartController($scope,$attrs,$element) {\n        angular.element($element).on(\"click\", function() {\n            [$scope.storyEvents, $scope.decisions, $scope.completedPages].forEach(function(A) {\n                while (A.length > 0) {\n                    A.pop();\n                }\n            });\n            $scope.$apply();\n        });\n    }\n})();","(function() {\n    'use strict';\n\n    angular\n    .module('cyo')\n    .directive('story', story);\n\n    story.$inject = [];\n\n    function story() {\n        return {\n            restrict: 'EA',\n            scope: true,\n            controller: 'storyController'\n        }\n    }\n})();"," (function() {\n    'use strict';\n\n    angular\n        .module('cyo')\n        .controller('storyController', storyController)\n\n    storyController.$inject = ['$scope','$attrs','$element','storyService','$parse'];\n\n    function storyController($scope,$attrs,$element,storyService,$parse) {\n\n        var storyName;  \n\n        if($attrs.hasOwnProperty('story')) {\n            storyName = $attrs.story;\n        }\n        else if($attrs.hasOwnProperty('name')) {\n            storyName = $attrs.name;\n        }\n        else {\n            storyName = $attrs.$attr[Object.keys($attrs.$attr)[0]];\n        }\n\n        storyName = $parse(storyName)($scope);\n\n        $scope = angular.extend($scope, storyService.getStory(storyName));\n\n        var updateStory = function updateStory() {\n            $scope = angular.extend($scope, storyService.getStory(storyName));\n        }\n\n        storyService.registerStory(updateStory);\n    }\n})();\n","(function() {\n    'use strict';\n\n    angular\n        .module('cyo')\n        .factory('storyService', storyService)\n\n    storyService.$inject = [];\n\n    function storyService() {\n\n        var story = function() {\n            this.storyEvents = [];\n            this.choices = [];\n            this.pages = [];\n            this.completedPages = [];\n            this.decisions = ['intro'];\n        };\n\n        var stories = {};\n        var updateFunctions = [];\n\n        function registerStory(func) {\n            updateFunctions.push(func);\n        }\n\n        function updateStories() {\n            console.log(updateFunctions);\n            for (i = 0; i < updateFunctions.length; i++) {\n                updateFunctions[i]();\n            }\n        }\n\n        function getStory(storyName) {\n            if(!stories.hasOwnProperty(storyName)) {\n                stories[storyName] = new story();\n            }\n            return stories[storyName];\n        }\n\n        function resetStory(storyName) {\n            stories[storyName].storyEvents = [];\n            stories[storyName].choices = [];\n            stories[storyName].completedPages = [];\n            stories[storyName].decisions = ['intro'];\n            updateStories();\n            return;\n        }\n\n        return {\n            stories: stories,\n            getStory: getStory,\n            resetStory: resetStory,\n            registerStory: registerStory\n        }\n    }\n})();"],"sourceRoot":"/source/"}